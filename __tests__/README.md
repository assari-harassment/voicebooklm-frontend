# Frontend 認証コンポーネントテスト

## テスト対象コンポーネント

### 1. LoginScreen (`app/login.tsx`)
- Requirements: 9.1, 9.2, 9.13

**テストシナリオ**:
- [ ] Google ログインボタンが表示される
- [ ] タイトル「VoiceBookLM」とサブタイトルが表示される
- [ ] ボタンタップで Google OAuth フローが開始される
- [ ] ログイン成功後、メイン画面へ遷移する
- [ ] エラー時にエラーメッセージが表示される

### 2. SettingsScreen (`app/settings.tsx`)
- Requirements: 10.12, 10.14, 12.1, 12.2, 12.3, 12.7, 12.8, 12.9

**テストシナリオ**:
- [ ] ユーザー情報（名前、メール）が表示される
- [ ] ログアウトボタンが表示される
- [ ] アカウント削除ボタンが表示される
- [ ] ログアウトボタンタップでログアウト処理が実行される
- [ ] アカウント削除ボタンタップで確認ダイアログが表示される
- [ ] 確認ダイアログでキャンセル可能
- [ ] 確認ダイアログで削除実行可能

### 3. 認証状態管理 (`app/_layout.tsx`)
- Requirements: 10.1, 10.2, 10.3, 10.11

**テストシナリオ**:
- [ ] アプリ起動時に認証状態が確認される
- [ ] トークンが有効な場合、メイン画面が表示される
- [ ] トークンが無効な場合、ログイン画面へリダイレクトされる
- [ ] トークンリフレッシュが必要な場合、自動リフレッシュされる

### 4. AuthService (`services/AuthService.ts`)

**テストシナリオ**:
- [ ] `loginWithGoogle`: API 呼び出しとトークン保存
- [ ] `refreshAccessToken`: トークンリフレッシュとローテーション
- [ ] `logout`: トークン削除と API 呼び出し
- [ ] `deleteAccount`: アカウント削除と API 呼び出し
- [ ] `checkAuthState`: トークン有効性チェックと自動リフレッシュ

## 手動テスト手順

### 1. ログイン
1. アプリを起動
2. ログイン画面が表示されることを確認
3. 「Google でログイン」ボタンをタップ
4. Google OAuth フローが開始されることを確認
5. 認証後、メイン画面へ遷移することを確認

### 2. 認証状態復元
1. アプリを完全に終了
2. アプリを再起動
3. 自動ログインされ、メイン画面が表示されることを確認

### 3. ログアウト
1. メイン画面から設定アイコンをタップ
2. 設定画面が表示されることを確認
3. 「ログアウト」ボタンをタップ
4. ログイン画面へリダイレクトされることを確認

### 4. アカウント削除
1. 設定画面で「アカウント削除」ボタンをタップ
2. 確認ダイアログが表示されることを確認
3. 「キャンセル」でダイアログが閉じることを確認
4. 「削除する」でアカウントが削除され、ログイン画面へリダイレクトされることを確認

## テスト環境セットアップ（将来対応）

```bash
# Jest と React Testing Library のインストール
npm install --save-dev jest @testing-library/react-native @testing-library/jest-native jest-expo

# package.json にテストスクリプトを追加
{
  "scripts": {
    "test": "jest"
  },
  "jest": {
    "preset": "jest-expo"
  }
}
```

## 備考

- 現時点では手動テストで品質を確保
- Phase 2 以降で自動テストを追加予定
